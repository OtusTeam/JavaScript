.hidden[
  https://jakearchibald.com/2017/es-modules-in-browsers/
  [Asynchronous and deferred JavaScript execution explained
Last revised on September 13th, 2010 -  Peter Beverloo](https://peter.sh/experiments/asynchronous-and-deferred-javascript-execution-explained/)
  
  https://github.com/Polymer/pwa-starter-kit
  https://github.com/Polymer/lit-element
  https://github.com/Polymer/lit-html
]


.center.icon[![otus main](assets/otus-1.png)]

---

class: white
background-image: url(assets/title.svg)
.top.icon[![otus main](assets/otus-2.png)]

# Modern JavaScript Frameworks
## Обзор Polymer
### Александр Коржиков

---

class: top white
background-image: url(assets/sound.svg)
.top.icon[![otus main](assets/otus-2.png)]

.sound-top[
  # Как меня слышно и видно?
]

.sound-bottom[
  ## > Напишите в чат
  ### **+** если все хорошо
  ### **–** если есть проблемы cо звуком или с видео
]

---

# Темы предыдущего занятия

| ![Node](assets/icons/trim/node.png) |  |  |
|:-----------:|:-----------:|:-----------:|
| Node Summary |  |  |
|  | ![JS](assets/icons/trim/js.png) |  |
|  | DOM API |  |
|  | CSS Selectors |  |
|  | Events |  |
|  |  | ![Google Chrome](assets/icons/trim/google_chrome.png) |
|  |  | DevTools |

---

# Цели

- Понимать основные концепции `Polymer` для создания элементов и приложений
- Ориентироваться в веб спецификациях, на базе которых работает `Polymer`
- Сравнить альтернативные подходы и инструменты

---

# Темы

.right-image[![Polymer](assets/polymer.png)]

- Введение в Polymer
- Hello Polymer
- Web Standards
  - Ajax
  - ES6 Templates literals
  - Type Module
- Обзор инструментов
- Lit-HTML
  - Lit Element
  - pwa-starter-kit
  
---

# Docs

- [Official Guide](https://www.polymer-project.org/)

- [Google tutorials & guides](https://developers.google.com/web/fundamentals/web-components/)

- [PWA Starter Kit - Redux and state management](https://polymer.github.io/pwa-starter-kit/redux-and-state-management/)

- [Asynchronous and deferred JavaScript execution explained
Last revised on September 13th, 2010 -  Peter Beverloo](https://peter.sh/experiments/asynchronous-and-deferred-javascript-execution-explained/)

---

# About

.right-image[![polymer](assets/icons/trim/polymer.png)]

### Polymer is a JavaScript library that helps you create custom reusable HTML elements, and use them to build performant, maintainable apps
### The Polymer library provides a set of features for creating custom elements. These features are designed to make it easier and faster to make custom elements that work like standard DOM elements

---

# History

.right-image[![polymer](assets/icons/trim/polymer.png)]

- Прошлое - 2014-2015 - v1 для Material Design
- Прошлое - v2 - 2016+
- Настоящее - v3 - 2018+
- Будущее - Lit-HTML, Lit-Element

---

# Ключевые особенности

- Использование стандартов и веб технологий
- Все - элемент
- Витрина готовых компонент 

### https://www.webcomponents.org/ 

## Технологии

- Web Components
- HTML, CSS декларативный подход описания приложения
- JavaScript- бизнес логика, polyfills

---

# Вопрос

.right-image[![Web Components](assets/web_components.png)]

### Что описывают эти стандарты?

- Custom Elements 
- HTML Templates 
- Shadow DOM 
- HTML Imports

---

# Web Components

.right-image[![Web Components](assets/web_components.png)]

- `Custom Elements` для создания собственных HTML тэгов
- `HTML Templates` позволяет определять и использовать шаблоны для HTML 
- `Shadow DOM` инкапсулирует DOM и стили
- `HTML Imports` загружает HTML документы на страницу

---

# Пример Ajax

- XMLHttpRequest()
- `fetch()`
- WebSocket()
- JSONP

```
fetch(url)
  .then((response) => { /* ... */ })
  .then(/* ... */)

/*
 * When did you join github?
 * https://api.github.com/users/...
 */
```

---

# Polymer - все элемент

Например, `AJAX`

```bash
npm install @polymer/iron-ajax
```

```
<iron-ajax auto url="https://www.googleapis.com/youtube/v3/search" 
  params='{
    "part":"snippet", 
    "q":"polymer", 
    "key": "YOUTUBE_API_KEY", 
    "type": "video"
  }'
  handle-as="json"
  on-response="handleResponse"
  debounce-duration="300">
</iron-ajax>
```

[Demo](https://www.webcomponents.org/element/@polymer/iron-ajax/demo/demo/index.html)

---

# Пример paper-tabs

```bash
npm init -f
npm install @polymer/paper-tabs
polymer serve
```

```html
<!-- head -->
<script type="module">
 import '@polymer/paper-tabs/paper-tabs.js'
 import '@polymer/paper-tabs/paper-tab.js'
</script>
<!-- body -->
<paper-tabs selected="1">
 <paper-tab>ITEM ONE</paper-tab>
 <paper-tab>ITEM TWO</paper-tab>
 <paper-tab>ITEM THREE</paper-tab>
</paper-tabs>
```

---

# Hello Polymer Element

```html
<script type="module">
 import { PolymerElement, html } from '@polymer/polymer'

 class MyElement extends PolymerElement {
  static get properties() { 
    return { 
      mood: String 
    }
  }
  static get template() {
    return html`
      <style>.mood { color: green } </style>
      Web Components are <span class="mood">[[mood]]</span>!
    `
  }
 }

 customElements.define('my-element', MyElement)
</script>

<my-element mood="awesome"></my-element>
```

---

# Type Module

```html
<script type="module" src="main.mjs"></script>
<script nomodule src="fallback.js"></script>

<script type="module">
  import {addTextToBody} from './utils.mjs'

  addTextToBody('Modules are pretty cool.')
</script>
```

- `use strict` 
- `var` are not global
- idempotent loading
- `defer`

[Modules in Browsers](https://cdn.rawgit.com/jakearchibald/6110fb6df717ebca44c2e40814cc12af/raw/7fc79ed89199c2512a4579c9a3ba19f72c219bd8/
)

---

# Инструменты

- `polymer-cli` - для создания, тестирования, разработки и демонстрации элементов и приложений

```bash
polymer init
polymer serve
polymer test
polymer build
```

- https://www.webcomponents.org/ - коллекции компонент, в том числе `routing, layout, pwa`

---

# Test


Можно сохранить в `package.json scripts test` - `polymer test -l chrome --skip-selenium-install`

- Web-Component-Tester
  - Mocha - test framework
  - Chai - assertion
  - Sinon - spies, stubs, and mocks
  - Selenium - для тестирования в разных браузерах 

- WebDriverIO
- Puppeteer

---

# Polyfills

```bash
npm install @webcomponents/webcomponentsjs 
```

- webcomponents-lite.js - все вместе + platform (ES6 Promise, ...)
- webcomponents-loader.js - для динамической загрузки
- WebComponentsReady - событие готовности 

https://www.webcomponents.org/polyfills/ 

---

# Lit-HTML

```
import {
  html,
  render
} from 'lit-html'

const helloTemplate = (name) =>
  html `<div>Hello ${name}!</div>`
  
render(helloTemplate('Steve'), document.body)
```

> ES6 Template Literal HTML render library that "lets you write HTML templates with JavaScript template literals, and efficiently render and re-render those templates to DOM"

---

# ES6 Templates literals

- multiline
- expressions
- tagged

```
console.log(`Fifteen is ${a + b}, \nnot ${2 * a + b}.`)

function myTag(strings, personExp, ageExp) { 
  var str0 = strings[0] // "that " 
  var str1 = strings[1] // " is a " 
  return str0 + personExp + str1
}

var output = myTag`that ${person} is a ${age}`
```

---

# Задача

### Написать `tagged template` функцию `factorial()`
- возвращающую текст-выражение первых `N` чисел факториала

```
factorial`multiply this ${4}` 
// => `multiply this 1 * 2 * 3 * 4 and get 24`
```

---

# Lit-HTML API

```
import {html, render} from 'lit-html'
const helloTemplate = (name) =>
  html`<div>Hello ${name}!</div>`
  
render(helloTemplate('Steve'), document.body)
```

- html ES6 template tag used => TemplateResult
- render(TemplateResult, element)

---

# Features

### Parses string and creates `<template>`

- Nested Nodes
- Async 
- Directives (until, repeat)
- Extend

```
const render = () => 
  html`<p> 
    ${until(
      fetch('content.txt').then((r) => r.text()), 
      html`<span>Loading...</span>`
    )}
</p>`
html`<button class$="primary">Buy Now</button>`
html`<button on-click=${(e)=> this.onClickHandler(e)}>Buy Now</button>`
```

---

# Lit Element

- unidirectional data flow 
- own lifecycle and hooks
- Lit-HTML with Shadow DOM instead of Polymer

```
import {LitElement, html, property} from 
 '@polymer/lit-element'
 
class MyElement extends LitElement { 
  @property() foo = 'foo' 
  render() { 
    return html` 
      <style> :host([hidden]) { display: none } </style> 
      <h4>Foo: ${this.foo}</h4> 
      <slot></slot> 
    ` 
  }
}
customElements.define('my-element', MyElement)
```

---

# pwa-starter-kit

is a starting point for building PWAs

- all the PWA goodness (manifest, service worker)
- a responsive layout
- application theming
- example of using Redux for state management
- offline UI
- simple routing solution
- fast time-to-interactive and first-paint through the PRPL pattern
- easy deployment to prpl-server or static hosting
- unit and integrating testing starting points
- documentation about other advanced patterns

---

# На занятии

- Рассмотрели инструменты доступные разработчику для отладки web страниц
- Разобрали теорию и задачи, возникающие при работе с браузерной средой 
- Вспомнили что такое DOM API, как работают события в браузере

---

# Modern JavaScript Frameworks

.mario.mario-10[![mario](assets/mario.png)]

| ![JS](assets/icons/trim/js.png) | ![Node](assets/icons/trim/node.png) | ![Web Components](assets/icons/trim/webcomponents.png) | ![React](assets/icons/trim/react.png) | ![Vue](assets/icons/trim/vue.png) | ![Angular](assets/icons/trim/angular.png) |
|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|:-------------:|
| ![Google Chrome](assets/icons/trim/google_chrome.png) | ![NPM](assets/icons/trim/npm.png) | ![polymer](assets/icons/trim/polymer.png) | ![redux](assets/icons/trim/redux.png) | | ![ts](assets/icons/trim/ts.png) |
| | ![v8](assets/icons/trim/v8.png) | | ![react-router](assets/icons/trim/react-router.png) | | ![rxjs](assets/icons/trim/rxjs.png) |
| | ![Express](assets/icons/trim/express.png) | |
| | ![GraphQL](assets/icons/trim/graphql.png) | |

---

# Самостоятельная работа

![no homework](assets/no-homework.png)

---

class: white
background-image: url(assets/title.svg)
.top.icon[![otus main](assets/otus-2.png)]

# Спасибо за внимание!

- Как вам Polymer?

.black[ 
## Пожалуйста, пройдите опрос 
## в личном кабинете 
]
