.hidden[
  https://vaadin.com/tutorials/lit-element/starting-a-lit-element-project
  
  https://jakearchibald.com/2017/es-modules-in-browsers/
  [Asynchronous and deferred JavaScript execution explained
Last revised on September 13th, 2010 -  Peter Beverloo](https://peter.sh/experiments/asynchronous-and-deferred-javascript-execution-explained/)
  
  https://github.com/Polymer/pwa-starter-kit
  https://github.com/Polymer/lit-element
  https://github.com/Polymer/lit-html
  
  https://medium.com/ing-blog/ing-%EF%B8%8F-web-components-f52aacc71d7a
]

.center.icon[![otus main](assets/otus-1.png)]

---

class: white
background-image: url(assets/title.svg)
.top.icon[![otus main](assets/otus-2.png)]

# Modern JavaScript Frameworks
## Lit-HTML –∏ Polymer
### –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ö–æ—Ä–∂–∏–∫–æ–≤

---

class: top white
background-image: url(assets/sound.svg)
.top.icon[![otus main](assets/otus-2.png)]

.sound-top[
  # –ö–∞–∫ –º–µ–Ω—è —Å–ª—ã—à–Ω–æ –∏ –≤–∏–¥–Ω–æ?
]

.sound-bottom[
  ## > –ù–∞–ø–∏—à–∏—Ç–µ –≤ —á–∞—Ç
  ### **+** –µ—Å–ª–∏ –≤—Å–µ —Ö–æ—Ä–æ—à–æ
  ### **‚Äì** –µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã c–æ –∑–≤—É–∫–æ–º –∏–ª–∏ —Å –≤–∏–¥–µ–æ
]

---

# Changelog

- [Nordic.js](https://nordicjs.com/2019)

---

# –¢–µ–º—ã –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–Ω—è—Ç–∏—è

.right-image[
  ![Web Components](assets/icons/trim/webcomponents.png)
]

- Custom Elements
  - Standalone Elements
  - Built-in Elements
  - LifeCycle Hooks
  
- Shadow DOM
  - DOM
  - Slots
  - Styles

---

# –¢–µ–º—ã

.right-image[![Polymer](assets/web_components.png)]

- Web Standards
  - HTML Template
  - Script Type Module
  - ES6 Templates Literals
- Lit-HTML
  - Lit-Element
  - pwa-starter-kit
- Webpack

---

# –¶–µ–ª–∏

.right-image[![Polymer](assets/web_components.png)]

- –û—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –≤–µ–± —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è—Ö, –Ω–∞ –±–∞–∑–µ –∫–æ—Ç–æ—Ä—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç `Lit-HTML`
- –ü–æ–Ω–∏–º–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ `Polymer` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- –°—Ä–∞–≤–Ω–∏—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

---

class: center
## Web Standards

---

# Custom Elements with Shadow DOM

```javascript
customElements.define('hello-element',
  class extends HTMLElement {
    constructor() {
      super()
      this.attachShadow({
        mode: 'open'
      })
    }
    connectedCallback() {
      this.shadowRoot.innerHTML = '<a href="#">My link</a>'
    }
  }
)
```

---

# HTML Template

### "The template element is used to declare fragments of HTML that can be cloned and inserted in the document by script"

¬© WHATWG

```
<template id="mytemplate">
  <img src="" alt="great image">
  <div class="comment"></div>
</template>
```

### <template> element's content is not rendered

---

# importNode

### `document.importNode()` creates a new copy of the specified Node

```
const template = document.querySelector('#mytemplate')

template.content.querySelector('img').src = 'logo.png'
const clone = document.importNode(template.content, true) 
document.body.appendChild(clone)
```

- Template –∫–∞–∫ –±—É–¥—Ç–æ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ
- `<template>` –º–æ–∂–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≥–¥–µ —É–≥–æ–¥–Ω–æ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ
- Template - Yet Another `documentFragment`

---

# –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞

### –î–æ–±–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç —Å –ø–æ–º–æ—â—å—é `template` –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É co `script` –≤–Ω—É—Ç—Ä–∏

```
<template id="mytemplate">
 <script> /* ... */ </script>
 <!-- ... -->
</template>
// ...
/*
const clone = document.importNode(template.content, true) 
document.body.appendChild(clone)
*/
```

---

# Template & Shadow DOM

```html
<template id="mytemplate">
  <style>
    :host {
      color: red
    }
  </style>
  <img src="" alt="great image">
  <div class="comment">that's me</div>
</template>
```

```
const template = document.querySelector('#mytemplate')

const clone = document.importNode(template.content, true)
const div = document.createElement('div')
const root = div.attachShadow({ mode: 'open' })
root.appendChild(clone)

document.body.appendChild(div)
```

---

# HTML Template

### "Templates allow you to declare fragments of markup which are parsed as HTML, go unused at page load, but can be instantiated later on at runtime"

¬© Eric Bidelman

---

# Web Components

.right-image[![Web Components](assets/web_components.png)]

- `Custom Elements` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö HTML —Ç—ç–≥–æ–≤
- `HTML Templates` –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω—ã –¥–ª—è HTML 
- `Shadow DOM` –∏–Ω–∫–∞–ø—Å—É–ª–∏—Ä—É–µ—Ç DOM –∏ —Å—Ç–∏–ª–∏
- `HTML Imports` –∑–∞–≥—Ä—É–∂–∞–ª üòÇ HTML –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É

---

# Type Module

```html
<script type="module" src="main.mjs"></script>
<script nomodule src="fallback.js"></script>

<script type="module">
  import {addTextToBody} from './utils.mjs'

  addTextToBody('Modules are pretty cool.')
</script>
```

- `use strict` –≤–∫–ª—é—á–µ–Ω–æ
- `var` –Ω–µ –≥–ª–æ–±–∞–ª—å–Ω—ã
- *idempotent* –∑–∞–≥—Ä—É–∑–∫–∞
- `defer` –ø–æ–≤–µ–¥–µ–Ω–∏–µ

[Modules in Browsers](https://cdn.rawgit.com/jakearchibald/6110fb6df717ebca44c2e40814cc12af/raw/7fc79ed89199c2512a4579c9a3ba19f72c219bd8/
)

---

# ES6 Templates literals

- multiline
- expressions
- tagged

```
console.log(`Fifteen is ${a + b}, \nnot ${2 * a + b}.`)

function myTag(strings, personExp, ageExp) { 
  var str0 = strings[0] // "that " 
  var str1 = strings[1] // " is a " 
  return str0 + personExp + str1
}

var output = myTag`that ${person} is a ${age}`
```

---

# –ó–∞–¥–∞—á–∞

### –ù–∞–ø–∏—Å–∞—Ç—å `tagged template` —Ñ—É–Ω–∫—Ü–∏—é `factorial()`
- –≤–æ–∑–≤—Ä–∞—â–∞—é—â—É—é —Ç–µ–∫—Å—Ç-–≤—ã—Ä–∞–∂–µ–Ω–∏–µ –ø–µ—Ä–≤—ã—Ö `N` —á–∏—Å–µ–ª —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª–∞

```
factorial`multiply this ${4}` 
// => `multiply this 1 * 2 * 3 * 4 and get 24`
```

---

class: center
## Web Standards
## Q&A
## -> Lit-HTML

---

# Lit-HTML

```
import {
  html,
  render
} from 'lit-html'

const helloTemplate = (name) =>
  html`<div>Hello ${name}!</div>`
  
render(helloTemplate('Steve'), document.body)
```

> ES6 Template Literal HTML render library that "lets you write HTML templates with JavaScript template literals, and efficiently render and re-render those templates to DOM"

---

# Lit-HTML API

```
import {html, render} from 'lit-html'
const helloTemplate = (name) =>
  html`<div>Hello ${name}!</div>`
  
render(helloTemplate('Steve'), document.body)
```

- html ES6 template tag used => `TemplateResult`
- `render(TemplateResult, element)`

---

# Features

### Parses string and creates `<template>`

- Nested Nodes
- Async 
- Directives (until, repeat)
- Extend

```
const render = () => 
  html`<p> 
    ${until(
      fetch('content.txt').then((r) => r.text()), 
      html`<span>Loading...</span>`
    )}
</p>`
html`<button class$="primary">Buy Now</button>`
html`<button on-click=${(e)=> this.onClickHandler(e)}>Buy Now</button>`
```

---

# Demo

### [Pure Lit HTML render()](/Users/RD25XO/Developer/experiments/notes/otus/lit-html/pure.html)

.hidden[
---

# Demo

### [Local development() of Tree App](/Users/RD25XO/Developer/experiments/notes/otus/polymer/3/lit-html/project/index.html)
]

---

# [Lit Element](https://lit-element.polymer-project.org/)

- unidirectional data flow 
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ [lifecycle hooks](https://lit-element.polymer-project.org/guide/lifecycle)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `Shadow DOM`

```ts
import { LitElement, html, property, customElement } from 'lit-element'

@customElement('simple-greeting')
export class SimpleGreeting extends LitElement {
  @property() name = 'World'

  render() {
    return html`<p>Hello, ${this.name}!</p>`
  }
}
```

---

# [Lit Element](/Users/RD25XO/Developer/experiments/notes/otus/lit-html/lit-element.html)

```js
import { LitElement, html } from 'lit-element'

class SimpleGreeting extends LitElement {
  static get properties() {
    return { name: { type: String } }
  }

  constructor() {
    super()
    this.name = 'World'
  }
  
  render() {
    return html`<p>Hello, ${this.name}!</p>`
  }
}

customElements.define('simple-greeting', SimpleGreeting)
```

---

# About Polymer

.right-image[![polymer](assets/icons/trim/polymer.png)]

### Polymer is a JavaScript library that helps you create custom reusable HTML elements, and use them to build performant, maintainable apps
### The Polymer library provides a set of features for creating custom elements. These features are designed to make it easier and faster to make custom elements that work like standard DOM elements

- –ü—Ä–æ—à–ª–æ–µ 
  - v1 - 2014-2015 - –¥–ª—è Material Design
  - v2 - 2016+ 
  - v3 - 2018+
- –ù–∞—Å—Ç–æ—è—â–µ–µ & –ë—É–¥—É—â–µ–µ - Lit-HTML, Lit-Element

---

# –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤ –∏ –≤–µ–± —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
- –í—Å–µ - —ç–ª–µ–º–µ–Ω—Ç
- –í–∏—Ç—Ä–∏–Ω–∞ –≥–æ—Ç–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç 

### https://www.webcomponents.org/ 

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Web Components
- HTML, CSS –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –æ–ø–∏—Å–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- JavaScript- –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞, polyfills

---

# Polymer - –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç

–ù–∞–ø—Ä–∏–º–µ—Ä, `AJAX`

```bash
npm install @polymer/iron-ajax
```

```
<iron-ajax auto url="https://www.googleapis.com/youtube/v3/search" 
  params='{
    "part":"snippet", 
    "q":"polymer", 
    "key": "YOUTUBE_API_KEY", 
    "type": "video"
  }'
  handle-as="json"
  on-response="handleResponse"
  debounce-duration="300">
</iron-ajax>
```

[Example](https://www.webcomponents.org/element/@polymer/iron-ajax/demo/demo/index.html)

---

# –ü—Ä–∏–º–µ—Ä paper-tabs

```bash
npm init -f
npm install @polymer/paper-tabs
polymer serve
```

```html
<!-- head -->
<script type="module">
 import '@polymer/paper-tabs/paper-tabs.js'
 import '@polymer/paper-tabs/paper-tab.js'
</script>
<!-- body -->
<paper-tabs selected="1">
 <paper-tab>ITEM ONE</paper-tab>
 <paper-tab>ITEM TWO</paper-tab>
 <paper-tab>ITEM THREE</paper-tab>
</paper-tabs>
```

---

# Hello Polymer Element

```html
<script type="module">
 import { PolymerElement, html } from '@polymer/polymer'

 class MyElement extends PolymerElement {
  static get properties() { 
    return { 
      mood: String 
    }
  }
  static get template() {
    return html`
      <style>.mood { color: green } </style>
      Web Components are <span class="mood">[[mood]]</span>!
    `
  }
 }

 customElements.define('my-element', MyElement)
</script>

<my-element mood="awesome"></my-element>
```

---

# –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

- `polymer-cli` - –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

```bash
polymer init
polymer serve
polymer test
polymer build
```

- https://www.webcomponents.org/ - –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –≤ —Ç–æ–º —á–∏—Å–ª–µ `routing, layout, pwa`

---

# Test

–ú–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ `package.json scripts test` - `polymer test -l chrome --skip-selenium-install`

- Web-Component-Tester
  - Mocha - test framework
  - Chai - assertion
  - Sinon - spies, stubs, and mocks
  - Selenium - –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Ä–∞–∑–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö 

- WebDriverIO
- Puppeteer

---

# Polyfills

```bash
npm install @webcomponents/webcomponentsjs 
```

- `webcomponents-lite.js` - –≤—Å–µ –≤–º–µ—Å—Ç–µ + platform (ES6 Promise, ...)
- `webcomponents-loader.js` - –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- `WebComponentsReady` - —Å–æ–±—ã—Ç–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ 

https://www.webcomponents.org/polyfills/ 

---

# pwa-starter-kit

Is a starting point for building PWAs

- All the PWA goodness (manifest, service worker)
- A responsive layout
- Application theming
- Example of using Redux for state management
- Offline UI
- Simple routing solution
- Fast time-to-interactive and first-paint using the PRPL pattern
- Easy deployment to prpl-server or static hosting
- Unit and integration testing starting points
- Documentation about other advanced patterns

---

# Docs

- [Official Guide](https://www.polymer-project.org/)

- [Google tutorials & guides](https://developers.google.com/web/fundamentals/web-components/)

a
---

# –ù–∞ –∑–∞–Ω—è—Ç–∏–∏

- –†–∞–∑–æ–±—Ä–∞–ª–∏ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ `Polymer` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- –†–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏ —Ç–µ—Ö–Ω–∏–∫–∏, –Ω–∞ –±–∞–∑–µ –∫–æ—Ç–æ—Ä—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç `Lit-HTML`
- –°—Ä–∞–≤–Ω–∏—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

---

# Modern JavaScript Frameworks

.mario.mario-5[![mario](assets/mario.png)]

| ![JS](assets/icons/trim/js.png) | ![React](assets/icons/trim/react.png) | ![Node](assets/icons/trim/node.png) |  | ![Vue](assets/icons/trim/vue.png) | ![Angular](assets/icons/trim/angular.png) |
|:---:|:---:|:---:|:---:|:---:|:---:|
| ![Google Chrome](assets/icons/trim/google_chrome.png) | ![redux](assets/icons/trim/redux.png) | ![wasm](assets/web-assembly-logo.png) |  | | ![ts](assets/icons/trim/ts.png) |
| ![Web Components](assets/icons/trim/webcomponents.png) | ![react-router](assets/icons/trim/react-router.png) | ![v8](assets/icons/trim/v8.png) |  | | ![rxjs](assets/icons/trim/rxjs.png) |
| ![polymer](assets/icons/trim/polymer.png) | | ![Express](assets/icons/trim/express.png) |
| ![NPM](assets/icons/trim/npm.png) | | ![GraphQL](assets/icons/trim/graphql.png) |

---

# –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞

–°–¥–µ–ª–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–∫–∞–∑–∞ –¥–µ—Ä–µ–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é `Custom Elements, Shadow DOM, Lit-Element, Lit-HTML –∏–ª–∏ Polymer` - `my-tree` –∏ `my-leaf` 

```
var obj = {
  id: 1,
  items: [{
    id: 2,
    items: [{
      id: 3
    }]
  }]
}

<my-tree data="${obj}" id="1">
  <my-tree data="${obj.items[0]}" id="2">
    <my-leaf data="${obj.items[0].items[0]}" id="3"></my-leaf>
  </my-tree>
</my-tree>
```


---

class: white
background-image: url(assets/title.svg)
.top.icon[![otus main](assets/otus-2.png)]

# –°–ø–∞—Å–∏–±–æ –∑–∞ –≤–Ω–∏–º–∞–Ω–∏–µ!

- –ö–∞–∫ }–≤–∞–º Polymer?

.black[ 
## –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–π–¥–∏—Ç–µ [–æ–ø—Ä–æ—Å](https://otus.ru/polls/5412/)
## –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ 
]

---

# –í–æ–ø—Ä–æ—Å—ã

```
var templatestr2 = `<template id="template2"><script>alert(1)</script></template>`‚Ä®document.body.innerHTML+=templatestr2‚Ä©var clone = document.importNode(template2.content,true);‚Ä®document.body.appendChild(clone)
```

### –Ω–∞ —Å–∞–π—Ç–µ –≤ –∫—É—Ä—Å–µ —ç—Ç–æ–≥–æ –¥–∑ –Ω–µ—Ç‚Ä©